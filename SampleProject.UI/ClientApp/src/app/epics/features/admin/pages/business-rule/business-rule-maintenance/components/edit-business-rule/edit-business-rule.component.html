<div mat-dialog-title>
  <div class="m-0 d-flex justify-content-between align-items-center dialog-title">
    <p class="mb-0 mt-1 ps-2"> Edit Business Rule </p>
    <div class="text-end">
      <button
        mat-icon-button
        (click)="handleCancel()"
      >
        <i class="las la-times"></i>
      </button>
    </div>
  </div>
</div>


<div mat-dialog-content>
  <form nz-form class="w-100" [nzLayout]="'vertical'" [formGroup]="updateBusinessRuleForm">

    <div class="row">
      <div class="col-sm-4">
        <nz-form-label>
          Reporting Type
        </nz-form-label>
        <nz-form-item>
          <nz-form-control nzHasFeedback>
            <input nz-input formControlName="reportingId"
                   [readOnly]="true" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label class="required">
            Segment
          </nz-form-label>
          <nz-form-control nzHasFeedback>
            <input nz-input formControlName="segmentName"
                   [readOnly]="true" />
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label class="required">Description</nz-form-label>
          <nz-form-control nzHasFeedback nzErrorTip="Message is required">
            <textarea nz-input formControlName="description" required
                      maxlength="50"></textarea>
          </nz-form-control>
        </nz-form-item>


        <nz-form-item>
          <nz-form-label class="required">
            Rule Execution Point
          </nz-form-label>
          <nz-select nzPlaceHolder="Select" formControlName="ruleExecutionPoint" nzSize="default">
            <nz-option nzLabel="After source download" nzValue="1"></nz-option>
            <nz-option nzLabel="Before map and verification" nzValue="2"></nz-option>
            <nz-option nzLabel="After map and verification" nzValue="3"></nz-option>
          </nz-select>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label class="required">Executing Sequence</nz-form-label>
          <nz-form-control nzHasFeedback>
            <input nz-input formControlName="sequence" required
                   [readOnly]="false"/>
          </nz-form-control>
        </nz-form-item>

        <nz-form-item>
          <nz-form-label class="required">
            Status
          </nz-form-label>
          <nz-select nzPlaceHolder="Select the Status" formControlName="status" nzSize="default">
            <nz-option nzLabel="Active" nzValue="1"></nz-option>
            <nz-option nzLabel="Inactive" nzValue="2"></nz-option>
          </nz-select>
        </nz-form-item>

      </div>
      <div class="col-sm-8">
        <div class="card">

          <div class="card-header">
            Query
          </div>
          <div class="card-body" style="height: 475px">
            <ngx-codemirror

              formControlName="query"
              [options]="options"
            ></ngx-codemirror>
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex justify-content-end">
      <button
        class="me-2"
        style="width: 200px"
        nz-button nzType="primary"
        (click)="onTestQuery()"
        [disabled]="!updateBusinessRuleForm.valid || !isFormDirty"
      >
        Verify & Save
      </button>

      <button
        class=" ms-2"
        style="width: 200px"
        nz-button nzType="default" (click)="handleCancel()">
        Cancel
      </button>
    </div>
  </form>
</div>
